{
  "protocol": "warp:3.0.0",
  "chain": "multiversx",
  "name": "PeerMe MultiSig: Propose SC Upgrade",
  "title": "Propose smart contract upgrade",
  "description": "Create a proposal to upgrade an existing smart contract from source code using the MultiSig wallet. This allows the MultiSig to upgrade contracts that require multiple approvals. The proposal requires quorum approval before execution.",
  "vars": {
    "MULTISIG_ADDRESS": "query:multisig"
  },
  "actions": [
    {
      "type": "contract",
      "label": "Create proposal",
      "address": "{{MULTISIG_ADDRESS}}",
      "func": "proposeSCUpgradeFromSource",
      "args": [],
      "gasLimit": 10000000,
      "abi": "INJECT:peerme/multisig.abi.json",
      "inputs": [
        {
          "name": "Contract Address",
          "as": "SC_ADDRESS",
          "description": "The address of the contract to upgrade.",
          "type": "address",
          "position": "arg:1",
          "source": "field",
          "required": true
        },
        {
          "name": "EGLD Amount",
          "as": "AMOUNT",
          "description": "The amount of EGLD to send with upgrade (in wei, will be scaled by 18 decimals).",
          "type": "biguint",
          "position": "arg:2",
          "source": "field",
          "required": true,
          "min": 0,
          "modifier": "scale:18"
        },
        {
          "name": "Source Address",
          "as": "SOURCE_ADDRESS",
          "description": "The address of the source contract to upgrade from.",
          "type": "address",
          "position": "arg:3",
          "source": "field",
          "required": true
        },
        {
          "name": "Code Metadata",
          "as": "CODE_METADATA",
          "description": "Code metadata (hex encoded).",
          "type": "string",
          "position": "arg:4",
          "source": "field",
          "required": true
        },
        {
          "name": "Arguments",
          "as": "ARGUMENTS",
          "description": "Upgrade arguments (hex encoded bytes).",
          "type": "string",
          "position": "arg:6",
          "source": "field",
          "required": false
        }
      ]
    }
  ],
  "output": {
    "ACTION_ID": "out",
    "ACTION_ID_NUMBER": "transform:() => Number(results.ACTION_ID)"
  },
  "messages": {
    "success": "Proposal created successfully. Action ID: {{ACTION_ID_NUMBER}}. The smart contract upgrade proposal is now awaiting signatures.",
    "card": "Proposal #{{ACTION_ID_NUMBER}}: Upgrade Smart Contract"
  },
  "alerts": {
    "proposal_created": {
      "label": {
        "en": "Get notified when this proposal is signed",
        "de": "Benachrichtigung erhalten, wenn dieser Vorschlag unterzeichnet wird"
      },
      "trigger": "event:sign",
      "subject": {
        "en": "MultiSig upgrade proposal signed",
        "de": "MultiSig-Upgrade-Vorschlag unterzeichnet"
      },
      "body": {
        "en": "A board member has signed proposal #{{ACTION_ID_NUMBER}} to upgrade a smart contract",
        "de": "Ein Vorstandsmitglied hat Vorschlag #{{ACTION_ID_NUMBER}} zur Aktualisierung eines Smart Contracts unterzeichnet"
      }
    }
  }
}
